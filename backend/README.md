# Backend Schedule Breakdown

4 weeks left

- Week 3 (11/3-11/9) : Complete CRUD for recipes
- Week 4 (11/10-11/16) : Work on additional APIs
- Week 5 (11/17-11/23): Test backend APIs from frontend UI and bug fix
- Week 6 (11/24-11/30): Test backend APIs from frontend UI and bug fix

# Instruction to host on Heroku

- git checkout master
- heroku login
- heroku git:remote -a project-mkb
- on root, npm run deploy-server
  ("git subtree push --prefix backend heroku master")

# API Documentation

# Table of Contents

### Users

- [POST /users/signup](#post-userssignup)
- [POST /users/signin](#post-userssignin)
- [POST /users/update](#post-usersupdate)
- [GET /users](#get-users)

### Recipes

- [POST /recipes/add](#post-recipesadd)
- [GET /recipes/listRecs](#get-recipeslistrecs)
- [GET /recipes/get/:id](#get-recipesgetid)
- [POST /recipes/update/:id](#post-recipesupdateid)
- [DELETE /recipes/delete/:id](#delete-recipesdeleteid)
- [POST /recipes/clone/:id](#post-recipescloneid)

# Users

## POST /users/signup

### Request body: (email, password, confirm password)

| Property                | Description         |
| ----------------------- | ------------------- |
| email: String           | email address       |
| password: String        | password            |
| confirmPassword: String | password to confirm |

### Response: (Created user info)

| Property                | Description                               |
| ----------------------- | ----------------------------------------- |
| \_id: String            | document id generated by mongodb          |
| uid: String             | user id generated by firebase             |
| email: String           | email address                             |
| displayName: String     | if available from google, otherwise null  |
| preferences: [String]   | empty on signup, update after questionare |
| photoURL: String        | if available from google, otherwise null  |
| country: String         | empty on signup, update after questionare |
| cuisine: String         | empty on signup, update after questionare |
| createdAt: String(Date) | generated by mongodb                      |
| updatedAt: String(Date) | generated by mongodb                      |
| token: String           | id token                                  |

### Errors:

- username, password, confirm password are empty
- email format is not correct
- password and confirmPassword don't match
- username already exist (firebase)
- password length is 6 or less (firebase)

## POST /users/signin

### Request body: (email, password)

| Property         | Description   |
| ---------------- | ------------- |
| email: String    | email address |
| password: String | password      |

### Response: (Signed in user info)

| Property                | Description                               |
| ----------------------- | ----------------------------------------- |
| \_id: String            | document id generated by mongodb          |
| uid: String             | user id generated by firebase             |
| email: String           | email address                             |
| displayName: String     | if available from google, otherwise null  |
| preferences: [String]   | empty on signup, update after questionare |
| photoURL: String        | if available from google, otherwise null  |
| country: String         | empty on signup, update after questionare |
| cuisine: String         | empty on signup, update after questionare |
| createdAt: String(Date) | generated by mongodb                      |
| updatedAt: String(Date) | generated by mongodb                      |
| token: String           | id token                                  |

### Errors:

- username or password are empty
- email format is not correct
- no user is found
- password is wrong

## POST /users/update

### Request body: (User info to update)

| Property              | Description                              |
| --------------------- | ---------------------------------------- |
| displayName: String   | if available from google, otherwise null |
| preferences: [String] | update after questionare                 |
| photoURL: String      | if available from google, otherwise null |
| country: String       | update after questionare                 |
| cuisine: String       | update after questionare                 |

### Response: (Updated user info)

| Property                | Description                              |
| ----------------------- | ---------------------------------------- |
| \_id: String            | document id generated by mongodb         |
| uid: String             | user id generated by firebase            |
| email: String           | email address                            |
| displayName: String     | if available from google, otherwise null |
| preferences: [String]   | update after questionare                 |
| photoURL: String        | if available from google, otherwise null |
| country: String         | update after questionare                 |
| cuisine: String         | update after questionare                 |
| createdAt: String(Date) | generated by mongodb                     |
| updatedAt: String(Date) | generated by mongodb                     |
| token: String           | id token                                 |

### Errors:

- auth token is not valid or expired
- user object contains one or more properties that have data types against Schema

## GET /users

### Request body: (N/A - user token is passed with req header)

| Property | Description |
| -------- | ----------- |
| N/A      | N/A         |

### Response: (Requested user info)

| Property                | Description                              |
| ----------------------- | ---------------------------------------- |
| \_id: String            | document id generated by mongodb         |
| uid: String             | user id generated by firebase            |
| email: String           | email address                            |
| displayName: String     | if available from google, otherwise null |
| preferences: [String]   | update after questionare                 |
| photoURL: String        | if available from google, otherwise null |
| country: String         | update after questionare                 |
| cuisine: String         | update after questionare                 |
| createdAt: String(Date) | generated by mongodb                     |
| updatedAt: String(Date) | generated by mongodb                     |

### Errors:

- auth token is not valid or expired

---

# Recipes

## POST /recipes/add

### Request body: (Recipe to create)

| Property              | Description                                 |
| --------------------- | ------------------------------------------- |
| title: String         |                                             |
| ingredients: [String] |                                             |
| directions: [String]  |                                             |
| prepTime: Number      |                                             |
| cookTime: Number      |                                             |
| servingSize: Number   |                                             |
| category: String      |                                             |
| cuisine: String       |                                             |
| footNote: [String]    |                                             |
| difficulty: Number    |                                             |
| mainImage: String     | url of the image                            |
| images: [String]      | array of urls of the images                 |
| tags: [String]        | will be used for recommendations and search |

### Response: (Created recipe)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| mainImage: String     | url of the image                              |
| images: [String]      | array of urls of the images                   |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired

## GET /recipes/listRecs

### Request body: (N/A - calculate recommendation using user info)

| Property | Description |
| -------- | ----------- |
| N/A      | N/A         |

### Response: (Array of recommended recipes)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| mainImage: String     | url of the image                              |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| images: [String]      | array of urls of the images                   |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired

## GET /recipes/get/:id

### Request body: (ID of the recipe to get)

| Property | Description |
| -------- | ----------- |
| \_id     | recipe id   |

### Response: (Requested recipe)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| mainImage: String     | url of the image                              |
| images: [String]      | array of urls of the images                   |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired

## POST /recipes/update/:id

### Request body: (Recipe to update)

- Updated recipe

| Property              | Description                                 |
| --------------------- | ------------------------------------------- |
| title: String         |                                             |
| ingredients: [String] |                                             |
| directions: [String]  |                                             |
| prepTime: Number      |                                             |
| cookTime: Number      |                                             |
| servingSize: Number   |                                             |
| category: String      |                                             |
| cuisine: String       |                                             |
| footNote: [String]    |                                             |
| difficulty: Number    |                                             |
| mainImage: String     | url of the image                            |
| images: [String]      | array of urls of the images                 |
| tags: [String]        | will be used for recommendations and search |

### Response: (Updated recipe)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| mainImage: String     | url of the image                              |
| images: [String]      | array of urls of the images                   |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired

## DELETE /recipes/delete/:id

### Request body: (ID of the recipe to delete)

| Property | Description |
| -------- | ----------- |
| \_id     | recipe id   |

### Response: (Deleted recipe)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| mainImage: String     | url of the image                              |
| images: [String]      | array of urls of the images                   |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired

## POST /recipes/clone/:id

### Request body: (ID of the recipe to clone)

| Property | Description |
| -------- | ----------- |
| \_id     | recipe id   |

### Response: (Cloned recipe)

| Property              | Description                                   |
| --------------------- | --------------------------------------------- |
| \_id: String          | recipe id                                     |
| title: String         |                                               |
| ingredients: [String] |                                               |
| directions: [String]  |                                               |
| prepTime: Number      |                                               |
| cookTime: Number      |                                               |
| totalTime: Number     | prepTime + cookTime                           |
| servingSize: Number   |                                               |
| category: String      |                                               |
| cuisine: String       |                                               |
| footNote: [String]    |                                               |
| difficulty: Number    |                                               |
| mainImage: String     | url of the image                              |
| images: [String]      | array of urls of the images                   |
| tags: [String]        | will be used for recommendations and search   |
| rating: Number        | zero at first, will be updated by other users |
| uid: String           | user id                                       |
| createdAt: String     |                                               |
| updatedAt: String     |                                               |

### Errors:

- auth token is not valid or expired
